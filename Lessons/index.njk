---
layout: layouts/base.njk
title: Home
permalink: /
---

<!-- Sidebar for Course List -->
<div id="courseSidebar" style="position: fixed; left: -280px; top: 0; width: 280px; height: 100vh; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); box-shadow: 4px 0 20px rgba(0,0,0,0.15); z-index: 1000; overflow-y: auto; transition: left 0.3s ease; padding: 20px;">
  <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
    <h3 style="color: white; margin: 0; font-size: 1.25rem;">üìö Courses</h3>
    <button onclick="toggleSidebar()" style="background: rgba(255,255,255,0.2); border: none; color: white; width: 32px; height: 32px; border-radius: 8px; cursor: pointer; font-size: 1.2rem;">‚úï</button>
  </div>

  <div id="sidebarCourseList">
    {% for course in collections.courses %}
    <a href="{{ course.url }}" style="display: block; padding: 12px; background: rgba(255,255,255,0.1); border-radius: 12px; margin-bottom: 10px; text-decoration: none; color: white; transition: all 0.2s;" onmouseover="this.style.background='rgba(255,255,255,0.2)'" onmouseout="this.style.background='rgba(255,255,255,0.1)'">
      <div style="font-weight: 600; font-size: 0.9rem; margin-bottom: 4px;">{% if course.data.courseId %}{{ course.data.courseId }}{% endif %}</div>
      <div style="font-size: 0.85rem; opacity: 0.9;">{{ course.data.title or 'Untitled' }}</div>
      {% if course.data.level %}
      <span style="display: inline-block; font-size: 0.75rem; background: rgba(255,255,255,0.2); padding: 2px 8px; border-radius: 6px; margin-top: 6px;">{{ course.data.level }}</span>
      {% endif %}
    </a>
    {% endfor %}

    {% if collections.courses.length == 0 %}
    <div style="text-align: center; padding: 2rem 1rem; color: rgba(255,255,255,0.8); font-size: 0.9rem;">
      <div style="font-size: 2rem; margin-bottom: 0.5rem;">üéì</div>
      <p style="margin: 0;">No courses yet. Create your first course!</p>
    </div>
    {% endif %}
  </div>
</div>

<!-- Toggle Button for Sidebar -->
<button id="sidebarToggle" onclick="toggleSidebar()" style="position: fixed; left: 20px; top: 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border: none; color: white; width: 50px; height: 50px; border-radius: 50%; cursor: pointer; font-size: 1.5rem; box-shadow: 0 4px 20px rgba(102, 126, 234, 0.4); z-index: 999; transition: all 0.3s;" onmouseover="this.style.transform='scale(1.1)'" onmouseout="this.style.transform='scale(1)'">
  ‚ò∞
</button>

<div style="text-align: center; margin-bottom: 4rem; padding: 4rem 2rem; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 0 0 48px 48px; margin-top: -2rem; box-shadow: 0 20px 60px rgba(102, 126, 234, 0.3);">
  <div style="max-width: 900px; margin: 0 auto;">
    <div style="display: inline-block; padding: 0.5rem 1.5rem; background: rgba(255, 255, 255, 0.15); backdrop-filter: blur(10px); border-radius: 20px; margin-bottom: 1.5rem; border: 1px solid rgba(255, 255, 255, 0.2);">
      <span style="color: rgba(255, 255, 255, 0.9); font-size: 0.9rem; font-weight: 600; letter-spacing: 0.05em;">AI-POWERED EDUCATION</span>
    </div>
    <h1 style="font-size: 4rem; margin-bottom: 1.5rem; color: white; font-weight: 900; letter-spacing: -0.03em; line-height: 1.1;">
      Intelligent Photocopier
    </h1>
    <p style="font-size: 1.4rem; color: rgba(255, 255, 255, 0.95); font-weight: 400; max-width: 700px; margin: 0 auto 2.5rem; line-height: 1.6;">
      Transform your educational content into professional, AI-enhanced programming courses with cutting-edge technology
    </p>
    <div style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap;">
      <a href="#courseBuilder" style="display: inline-block; padding: 1rem 2.5rem; background: white; color: #667eea; border-radius: 16px; font-weight: 700; text-decoration: none; box-shadow: 0 8px 30px rgba(0, 0, 0, 0.2); transition: all 0.3s ease; font-size: 1.1rem;" onmouseover="this.style.transform='translateY(-3px)'; this.style.boxShadow='0 12px 40px rgba(0, 0, 0, 0.3)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 8px 30px rgba(0, 0, 0, 0.2)'">
        Start Creating
      </a>
      <a href="#courses" style="display: inline-block; padding: 1rem 2.5rem; background: rgba(255, 255, 255, 0.1); backdrop-filter: blur(10px); color: white; border-radius: 16px; font-weight: 700; text-decoration: none; border: 2px solid rgba(255, 255, 255, 0.3); transition: all 0.3s ease; font-size: 1.1rem;" onmouseover="this.style.background='rgba(255, 255, 255, 0.2)'; this.style.borderColor='rgba(255, 255, 255, 0.5)'" onmouseout="this.style.background='rgba(255, 255, 255, 0.1)'; this.style.borderColor='rgba(255, 255, 255, 0.3)'">
        Browse Courses
      </a>
    </div>
  </div>
</div>

<!-- AI Course Builder - Moved to Top -->
<div id="courseBuilder-section" style="margin-bottom: 4rem; padding: 4rem 3rem; background: linear-gradient(135deg, #e0c3fc 0%, #8ec5fc 100%); border-radius: 32px; box-shadow: 0 12px 40px rgba(142, 197, 252, 0.3);">
  <div style="text-align: center; margin-bottom: 3rem;">
    <div style="display: inline-block; padding: 0.5rem 1.5rem; background: rgba(255, 255, 255, 0.3); backdrop-filter: blur(10px); border-radius: 12px; margin-bottom: 1rem; border: 1px solid rgba(255, 255, 255, 0.4);">
      <span style="color: #2d3748; font-size: 0.85rem; font-weight: 700; letter-spacing: 0.05em;">AI COURSE GENERATOR</span>
    </div>
    <h2 style="border: none; font-size: 2.75rem; margin-bottom: 1rem; font-weight: 800; color: #1a202c;">Create Your Course with AI</h2>
    <p style="font-size: 1.25rem; color: #2d3748; max-width: 600px; margin: 0 auto; line-height: 1.6;">
      Transform your ideas into professional programming courses instantly
    </p>
  </div>

  <div id="courseBuilder" style="background: white; padding: 3rem; border-radius: 28px; box-shadow: 0 8px 30px rgba(0,0,0,0.1); scroll-margin-top: 2rem;">

    <!-- Step 1: Material Input (Direct Entry) -->
    <div class="builder-step active" id="step1">
      <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 2rem;">
        <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; width: 48px; height: 48px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 800; font-size: 1.5rem;">1</div>
        <h3 style="margin: 0; font-size: 1.75rem;">Provide Your Course Material</h3>
      </div>

      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-bottom: 2rem;">
        <button class="input-method-btn active" onclick="selectInputMethod('paste', this)" style="padding: 1.5rem; background: white; border: 3px solid #667eea; border-radius: 20px; cursor: pointer; transition: all 0.3s; font-weight: 600; font-size: 1rem;">
          üìù Paste Text
        </button>
        <button class="input-method-btn" onclick="selectInputMethod('upload', this)" style="padding: 1.5rem; background: white; border: 3px solid #e2e8f0; border-radius: 20px; cursor: pointer; transition: all 0.3s; font-weight: 600; font-size: 1rem;">
          üìÑ Upload File
        </button>
      </div>

      <!-- Paste Text Area -->
      <div id="pasteArea" class="input-area">
        <textarea id="courseContent" placeholder="Paste your course outline, learning objectives, or any reference material here...

Example:
# Course: Advanced Python Design Patterns
## Learning Objectives
- Master creational patterns (Singleton, Factory, Builder)
- Implement structural patterns (Adapter, Decorator, Facade)
- Apply behavioral patterns (Observer, Strategy, Command)
- Write SOLID, maintainable code

## Topics to Cover
1. Introduction to Design Patterns
2. Creational Patterns with Examples
3. Structural Patterns in Practice
4. Behavioral Patterns for Clean Code
5. Real-world Applications" style="width: 100%; min-height: 300px; padding: 1.5rem; border: 2px solid #e2e8f0; border-radius: 16px; font-family: 'Fira Code', monospace; font-size: 0.95rem; resize: vertical;"></textarea>
      </div>

      <!-- Upload Area -->
      <div id="uploadArea" class="input-area" style="display: none;">
        <div style="border: 3px dashed #cbd5e0; border-radius: 20px; padding: 3rem; text-align: center; background: #f7fafc; cursor: pointer;" onclick="document.getElementById('fileInput').click()">
          <div style="font-size: 3rem; margin-bottom: 1rem;">üìÅ</div>
          <p style="font-size: 1.1rem; font-weight: 600; margin-bottom: 0.5rem;">Drop files here or click to browse</p>
          <p style="color: #718096; font-size: 0.9rem;">Supports PDF, TXT, DOCX, MD</p>
          <input type="file" id="fileInput" accept=".pdf,.txt,.docx,.md" style="display: none;" onchange="handleFileUpload(event)">
        </div>
        <div id="filePreview" style="margin-top: 1.5rem; display: none;"></div>
      </div>

      <button class="btn" onclick="
        alert('Button clicked!');
        console.log('Hiding all steps...');
        document.querySelectorAll('.builder-step').forEach(function(s) {
          s.style.display = 'none';
          console.log('Hid step:', s.id);
        });
        console.log('Now showing step2...');
        var step2 = document.getElementById('step2');
        if (step2) {
          step2.style.display = 'block';
          alert('Step 2 should now be visible!');
        } else {
          alert('ERROR: step2 element not found!');
        }
      " style="margin-top: 2rem; width: 100%; font-size: 1.1rem; padding: 1.25rem;">
        Continue to Configuration ‚Üí
      </button>
    </div>

    <!-- Step 2: Course Configuration -->
    <div class="builder-step" id="step2" style="display: none;">
      <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 2rem;">
        <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; width: 48px; height: 48px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 800; font-size: 1.5rem;">2</div>
        <h3 style="margin: 0; font-size: 1.75rem;">Configure Your Course</h3>
      </div>

      <div style="display: grid; gap: 1.5rem;">
        <div>
          <label style="display: block; font-weight: 600; margin-bottom: 0.5rem; color: #2d3748;">Course ID <span style="color: #e53e3e;">*</span></label>
          <input type="text" id="courseId" placeholder="e.g., B3-advanced-design-patterns" style="width: 100%; padding: 1rem; border: 2px solid #e2e8f0; border-radius: 12px; font-size: 1rem;">
          <p style="color: #718096; font-size: 0.85rem; margin-top: 0.5rem;">Format: [Letter][Number]-kebab-case (e.g., A1, B2, C3)</p>
        </div>

        <div>
          <label style="display: block; font-weight: 600; margin-bottom: 0.5rem; color: #2d3748;">Course Title <span style="color: #e53e3e;">*</span></label>
          <input type="text" id="courseTitle" placeholder="e.g., Advanced Python Design Patterns" style="width: 100%; padding: 1rem; border: 2px solid #e2e8f0; border-radius: 12px; font-size: 1rem;">
        </div>

        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem;">
          <div>
            <label style="display: block; font-weight: 600; margin-bottom: 0.5rem; color: #2d3748;">Level <span style="color: #e53e3e;">*</span></label>
            <select id="courseLevel" style="width: 100%; padding: 1rem; border: 2px solid #e2e8f0; border-radius: 12px; font-size: 1rem; background: white;">
              <option>Beginner</option>
              <option selected>Intermediate</option>
              <option>Advanced</option>
            </select>
          </div>
          <div>
            <label style="display: block; font-weight: 600; margin-bottom: 0.5rem; color: #2d3748;">Duration <span style="color: #e53e3e;">*</span></label>
            <select id="courseDuration" style="width: 100%; padding: 1rem; border: 2px solid #e2e8f0; border-radius: 12px; font-size: 1rem; background: white;">
              <option>1-2 hours</option>
              <option>2-3 hours</option>
              <option selected>3-4 hours</option>
              <option>4-5 hours</option>
              <option>5-6 hours</option>
              <option>Full day</option>
            </select>
          </div>
        </div>

        <div>
          <label style="display: block; font-weight: 600; margin-bottom: 0.5rem; color: #2d3748;">Description</label>
          <textarea id="courseDescription" placeholder="Brief description of what students will learn..." style="width: 100%; min-height: 100px; padding: 1rem; border: 2px solid #e2e8f0; border-radius: 12px; font-size: 1rem; resize: vertical;"></textarea>
        </div>

        <div>
          <label style="display: block; font-weight: 600; margin-bottom: 1rem; color: #2d3748;">Course Structure (Select Files to Generate)</label>
          <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem;">
            <label style="display: flex; align-items: center; gap: 0.5rem; padding: 1rem; background: #f0f9ff; border: 2px solid #3b82f6; border-radius: 12px; cursor: pointer;">
              <input type="checkbox" checked disabled> <strong>README.md</strong> <span style="color: #718096; font-size: 0.85rem;">(Required)</span>
            </label>
            <label style="display: flex; align-items: center; gap: 0.5rem; padding: 1rem; background: #f0f9ff; border: 2px solid #3b82f6; border-radius: 12px; cursor: pointer;">
              <input type="checkbox" id="incLessonContent" checked disabled> <strong>lesson-content.md</strong> <span style="color: #718096; font-size: 0.85rem;">(Required)</span>
            </label>
            <label style="display: flex; align-items: center; gap: 0.5rem; padding: 1rem; background: #f7fafc; border: 2px solid #e2e8f0; border-radius: 12px; cursor: pointer;">
              <input type="checkbox" id="incSummary" checked> <strong>summary.md</strong>
            </label>
            <label style="display: flex; align-items: center; gap: 0.5rem; padding: 1rem; background: #f7fafc; border: 2px solid #e2e8f0; border-radius: 12px; cursor: pointer;">
              <input type="checkbox" id="incReference" checked> <strong>reference/</strong>
            </label>
            <label style="display: flex; align-items: center; gap: 0.5rem; padding: 1rem; background: #f7fafc; border: 2px solid #e2e8f0; border-radius: 12px; cursor: pointer;">
              <input type="checkbox" id="incSolutions" checked> <strong>solutions/</strong>
            </label>
            <label style="display: flex; align-items: center; gap: 0.5rem; padding: 1rem; background: #f7fafc; border: 2px solid #e2e8f0; border-radius: 12px; cursor: pointer;">
              <input type="checkbox" id="incTests" checked> <strong>tests/</strong>
            </label>
          </div>
          <p style="color: #718096; font-size: 0.85rem; margin-top: 1rem;">
            ‚ÑπÔ∏è Matches the structure: <code>Lessons/[CourseID]/[files]</code>
          </p>
        </div>
      </div>

      <div style="display: flex; gap: 1rem; margin-top: 2rem;">
        <button class="btn" onclick="
          document.querySelectorAll('.builder-step').forEach(function(s) { s.style.display = 'none'; });
          document.getElementById('step1').style.display = 'block';
        " style="flex: 1; background: #e2e8f0; color: #4a5568;">
          ‚Üê Back
        </button>
        <button class="btn" onclick="
          (async function() {
            try {
              console.log('Generate button clicked - inline version');

              // Get form values
              var courseId = document.getElementById('courseId').value.trim();
              var courseTitle = document.getElementById('courseTitle').value.trim();
              var courseContent = document.getElementById('courseContent').value.trim();

              if (!courseId || !courseTitle) {
                alert('‚ö†Ô∏è Please fill in Course ID and Title');
                return;
              }

              // Show Step 3
              document.querySelectorAll('.builder-step').forEach(function(s) { s.style.display = 'none'; });
              document.getElementById('step3').style.display = 'block';

              // Prepare payload
              var payload = {
                courseId: courseId,
                title: courseTitle,
                level: document.getElementById('courseLevel').value,
                duration: document.getElementById('courseDuration').value,
                description: document.getElementById('courseDescription').value.trim(),
                content: courseContent || 'Create a comprehensive programming course',
                sections: {
                  summary: document.getElementById('incSummary').checked,
                  reference: document.getElementById('incReference').checked,
                  solutions: document.getElementById('incSolutions').checked,
                  tests: document.getElementById('incTests').checked
                }
              };

              console.log('Calling API with payload:', payload);

              // Call API
              var response = await fetch('http://localhost:5000/api/generate-course', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
              });

              if (!response.ok) {
                var error = await response.json();
                throw new Error(error.error || 'Failed to generate course');
              }

              var result = await response.json();
              console.log('API response:', result);

              // Show success (Step 4)
              document.querySelectorAll('.builder-step').forEach(function(s) { s.style.display = 'none'; });
              document.getElementById('step4').style.display = 'block';
              document.getElementById('courseLocation').textContent = 'Lessons/' + courseId + '/';

              alert('‚úÖ Course generated successfully!');

            } catch (error) {
              console.error('Error:', error);
              alert('‚ùå Error: ' + error.message + '\\n\\nMake sure API server is running on port 5000');
              document.querySelectorAll('.builder-step').forEach(function(s) { s.style.display = 'none'; });
              document.getElementById('step2').style.display = 'block';
            }
          })();
        " style="flex: 2; font-size: 1.1rem; background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); box-shadow: 0 4px 20px rgba(245, 87, 108, 0.4);">
          üöÄ Generate Course with AI
        </button>
      </div>
    </div>

    <!-- Step 3: Generation Progress -->
    <div class="builder-step" id="step3" style="display: none;">
      <div style="text-align: center; padding: 3rem 0;">
        <div class="loading-spinner" style="width: 80px; height: 80px; margin: 0 auto 2rem; border: 6px solid #e2e8f0; border-top: 6px solid #667eea; border-radius: 50%; animation: spin 1s linear infinite;"></div>
        <h3 style="font-size: 2rem; margin-bottom: 1rem;">Generating Your Course...</h3>
        <div id="progressSteps" style="max-width: 500px; margin: 0 auto;">
          <div class="progress-step" data-step="1" style="padding: 1rem; margin-bottom: 0.5rem; background: #f0f9ff; border-radius: 12px; display: flex; align-items: center; gap: 1rem;">
            <span style="font-size: 1.5rem;">‚úÖ</span>
            <span style="font-weight: 600;">Analyzing course material</span>
          </div>
          <div class="progress-step" data-step="2" style="padding: 1rem; margin-bottom: 0.5rem; background: #fef3c7; border-radius: 12px; display: flex; align-items: center; gap: 1rem;">
            <span style="font-size: 1.5rem;">‚è≥</span>
            <span style="font-weight: 600;">Creating course structure</span>
          </div>
          <div class="progress-step" data-step="3" style="padding: 1rem; margin-bottom: 0.5rem; background: #f7fafc; border-radius: 12px; display: flex; align-items: center; gap: 1rem; opacity: 0.5;">
            <span style="font-size: 1.5rem;">‚è∏Ô∏è</span>
            <span style="font-weight: 600;">Generating content with AI</span>
          </div>
          <div class="progress-step" data-step="4" style="padding: 1rem; background: #f7fafc; border-radius: 12px; display: flex; align-items: center; gap: 1rem; opacity: 0.5;">
            <span style="font-size: 1.5rem;">‚è∏Ô∏è</span>
            <span style="font-weight: 600;">Building static site</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Step 4: Success & Preview -->
    <div class="builder-step" id="step4" style="display: none;">
      <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 2rem;">
        <div style="background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white; width: 48px; height: 48px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.5rem;">‚úì</div>
        <h3 style="margin: 0; font-size: 1.75rem;">Course Generated Successfully!</h3>
      </div>

      <div id="outputPreview" style="background: #f7fafc; padding: 2rem; border-radius: 20px; margin-bottom: 2rem;">
        <div style="margin-bottom: 1.5rem;">
          <h4 style="font-size: 1.5rem; margin-bottom: 1rem;">üìã <span id="previewTitle">Your Course</span></h4>
          <div style="background: white; padding: 1.5rem; border-radius: 16px;" id="courseStructurePreview">
            <p style="margin: 0;"><strong>‚úì Course structure created</strong></p>
          </div>
        </div>
      </div>

      <div style="background: #fef3c7; padding: 1.5rem; border-radius: 16px; margin-bottom: 2rem;">
        <p style="margin: 0; font-weight: 600;">üìÅ Course Location:</p>
        <code style="background: white; padding: 0.5rem 1rem; border-radius: 8px; display: inline-block; margin-top: 0.5rem;" id="courseLocation">Lessons/[CourseID]/</code>
      </div>

      <div style="display: flex; gap: 1rem;">
        <button class="btn" onclick="resetBuilder()" style="flex: 1; background: #e2e8f0; color: #4a5568;">
          Create Another Course
        </button>
        <button class="btn" onclick="viewCourse()" style="flex: 2;">
          üëÄ View Generated Course
        </button>
      </div>
    </div>

  </div>
</div>

<style>
  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }

  .input-method-btn:hover {
    border-color: #667eea !important;
    transform: translateY(-2px);
  }

  .input-method-btn.active {
    border-color: #667eea !important;
    background: linear-gradient(135deg, #667eea10 0%, #764ba210 100%) !important;
  }

  #courseContent:focus, input:focus, select:focus, textarea:focus {
    outline: none;
    border-color: #667eea;
    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
  }
</style>

<script>
  let selectedInputMethod = 'paste';
  let generatedCourseId = '';

  function selectInputMethod(method, element) {
    selectedInputMethod = method;
    document.querySelectorAll('.input-method-btn').forEach(btn => btn.classList.remove('active'));
    element.classList.add('active');

    document.querySelectorAll('.input-area').forEach(area => area.style.display = 'none');
    document.getElementById(method + 'Area').style.display = 'block';
  }

  function nextStep(step) {
    console.log('nextStep function called with step:', step);
    alert('nextStep function executing for step: ' + step);

    // Simply switch to the requested step
    document.querySelectorAll('.builder-step').forEach(s => s.style.display = 'none');
    const targetStep = document.getElementById('step' + step);
    console.log('Target step element:', targetStep);

    if (targetStep) {
      targetStep.style.display = 'block';
      console.log('Step', step, 'is now visible');
      document.getElementById('courseBuilder').scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    } else {
      alert('ERROR: Could not find step' + step + ' element!');
    }
  }

  function prevStep(step) {
    nextStep(step);
  }

  function handleFileUpload(event) {
    const file = event.target.files[0];
    if (file) {
      const preview = document.getElementById('filePreview');
      preview.style.display = 'block';
      preview.innerHTML = `
        <div style="padding: 1.5rem; background: #d1fae5; border-radius: 16px; display: flex; align-items: center; gap: 1rem;">
          <span style="font-size: 2rem;">üìÑ</span>
          <div style="flex: 1;">
            <p style="margin: 0; font-weight: 600; color: #065f46;">${file.name}</p>
            <p style="margin: 0; color: #059669; font-size: 0.9rem;">${(file.size / 1024).toFixed(2)} KB</p>
          </div>
          <span style="color: #10b981; font-weight: 600; font-size: 1.5rem;">‚úì</span>
        </div>
      `;
    }
  }

  async function generateCourse() {
    // Get values
    const courseId = document.getElementById('courseId').value.trim();
    const courseTitle = document.getElementById('courseTitle').value.trim();
    const courseContent = document.getElementById('courseContent').value.trim();

    // Only check if required fields exist
    if (!courseId || !courseTitle) {
      alert('‚ö†Ô∏è Please fill in Course ID and Title');
      return;
    }

    generatedCourseId = courseId;
    nextStep(3);

    // Prepare API request
    const payload = {
      courseId: courseId,
      title: courseTitle,
      level: document.getElementById('courseLevel').value,
      duration: document.getElementById('courseDuration').value,
      description: document.getElementById('courseDescription').value.trim(),
      content: courseContent || 'Create a comprehensive programming course',
      sections: {
        summary: document.getElementById('incSummary').checked,
        reference: document.getElementById('incReference').checked,
        solutions: document.getElementById('incSolutions').checked,
        tests: document.getElementById('incTests').checked
      }
    };

    try {
      // Update progress: Analyzing
      updateProgress(2);

      // Call API
      const response = await fetch('http://localhost:5000/api/generate-course', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(payload)
      });

      if (!response.ok) {
        const error = await response.json();
        throw new Error(error.error || 'Failed to generate course');
      }

      const result = await response.json();

      // Update progress through steps
      updateProgress(3);
      await sleep(1500);
      updateProgress(4);
      await sleep(1500);

      // Show success
      showSuccess(result);

    } catch (error) {
      console.error('Error generating course:', error);
      alert(`‚ùå Error generating course:\n\n${error.message}\n\nMake sure the API server is running:\npython -m src.intelligent_photocopier.api`);
      // Reset to step 2
      nextStep(2);
    }
  }

  function sleep(ms) {
    return new Promise(resolve => setTimeout(resolve, ms));
  }

  function updateProgress(step) {
    const steps = document.querySelectorAll('.progress-step');
    const currentStep = steps[step - 1];

    // Mark previous steps as complete
    for (let i = 0; i < step - 1; i++) {
      steps[i].style.background = '#d1fae5';
      steps[i].querySelector('span:first-child').textContent = '‚úÖ';
    }

    // Mark current step as in progress
    currentStep.style.background = '#fef3c7';
    currentStep.style.opacity = '1';
    currentStep.querySelector('span:first-child').textContent = '‚è≥';
  }

  function showSuccess(result) {
    const steps = document.querySelectorAll('.progress-step');
    steps[3].style.background = '#d1fae5';
    steps[3].querySelector('span:first-child').textContent = '‚úÖ';

    setTimeout(() => {
      const courseId = result.courseId;
      const title = document.getElementById('courseTitle').value;
      const level = document.getElementById('courseLevel').value;
      const duration = document.getElementById('courseDuration').value;

      document.getElementById('previewTitle').textContent = title;
      document.getElementById('courseLocation').textContent = result.path;

      const filesCreated = result.filesCreated || [];

      document.getElementById('courseStructurePreview').innerHTML = `
        <p style="margin-bottom: 1rem;"><strong>üìö ${title}</strong></p>
        <p style="color: #718096; margin-bottom: 0.5rem;"><strong>Level:</strong> ${level} | <strong>Duration:</strong> ${duration}</p>
        <p style="color: #718096; margin-bottom: 1rem;"><strong>Course ID:</strong> <code>${courseId}</code></p>
        <hr style="margin: 1rem 0; border: none; border-top: 1px solid #e2e8f0;">
        <p style="font-weight: 600; margin-bottom: 0.5rem; color: #059669;">‚úì ${filesCreated.length} Files Generated:</p>
        <ul style="margin-left: 1.5rem; color: #4a5568; line-height: 1.8;">
          ${filesCreated.map(f => `<li>${f}</li>`).join('')}
        </ul>
        <div style="margin-top: 1.5rem; padding: 1rem; background: #d1fae5; border-radius: 12px;">
          <p style="margin: 0; color: #065f46; font-weight: 600;">${result.message}</p>
        </div>
      `;

      nextStep(4);
    }, 500);
  }

    setTimeout(() => {
      const courseId = document.getElementById('courseId').value;
      const courseTitle = document.getElementById('courseTitle').value;
      const level = document.getElementById('courseLevel').value;
      const duration = document.getElementById('courseDuration').value;

      document.getElementById('previewTitle').textContent = courseTitle;
      document.getElementById('courseLocation').textContent = `Lessons/${courseId}/`;

      const structure = [];
      structure.push('README.md - Course overview and learning objectives');
      structure.push('lesson-content.md - Main teaching content');
      if (document.getElementById('incSummary').checked) structure.push('summary.md - Key concepts summary');
      if (document.getElementById('incReference').checked) structure.push('reference/ - Quick reference materials');
      if (document.getElementById('incSolutions').checked) structure.push('solutions/ - Exercise solutions');
      if (document.getElementById('incTests').checked) structure.push('tests/ - Practice tests and quizzes');

      document.getElementById('courseStructurePreview').innerHTML = `
        <p style="margin-bottom: 1rem;"><strong>üìö ${courseTitle}</strong></p>
        <p style="color: #718096; margin-bottom: 0.5rem;"><strong>Level:</strong> ${level} | <strong>Duration:</strong> ${duration}</p>
        <p style="color: #718096; margin-bottom: 1rem;"><strong>Course ID:</strong> <code>${courseId}</code></p>
        <hr style="margin: 1rem 0; border: none; border-top: 1px solid #e2e8f0;">
        <p style="font-weight: 600; margin-bottom: 0.5rem;">Generated Files:</p>
        <ul style="margin-left: 1.5rem; color: #4a5568; line-height: 1.8;">
          ${structure.map(s => `<li>${s}</li>`).join('')}
        </ul>
      `;

      nextStep(4);
    }, 500);
  }

  function resetBuilder() {
    nextStep(1);
    document.getElementById('courseContent').value = '';
    document.getElementById('courseId').value = '';
    document.getElementById('courseTitle').value = '';
    document.getElementById('courseDescription').value = '';
    document.getElementById('fileInput').value = '';
    document.getElementById('filePreview').style.display = 'none';
    generatedCourseId = '';

    // Reset progress steps
    const steps = document.querySelectorAll('.progress-step');
    steps[0].style.background = '#f0f9ff';
    steps[0].querySelector('span:first-child').textContent = '‚úÖ';
    steps[1].style.background = '#fef3c7';
    steps[1].querySelector('span:first-child').textContent = '‚è≥';
    for (let i = 2; i < steps.length; i++) {
      steps[i].style.background = '#f7fafc';
      steps[i].style.opacity = '0.5';
      steps[i].querySelector('span:first-child').textContent = '‚è∏Ô∏è';
    }
  }

  function viewCourse() {
    if (generatedCourseId) {
      alert(`üéâ Opening course: ${generatedCourseId}\n\nIn a real implementation, this would:\n‚Ä¢ Rebuild the static site\n‚Ä¢ Navigate to /Lessons/${generatedCourseId}/`);
    }
  }
</script>

<div style="background: linear-gradient(135deg, #e0c3fc15 0%, #8ec5fc15 100%); padding: 3rem; border-radius: 32px; margin-bottom: 4rem; box-shadow: 0 8px 30px rgba(0,0,0,0.06);">
  <h2 style="border: none; text-align: center; margin-top: 0;">‚ú® What Makes This Special</h2>
  <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 2rem; margin-top: 2rem;">
    <div style="text-align: center; padding: 2rem; background: white; border-radius: 24px; box-shadow: 0 4px 20px rgba(0,0,0,0.06);">
      <div style="font-size: 3rem; margin-bottom: 1rem;">üìö</div>
      <h3 style="margin: 0.5rem 0; font-size: 1.25rem;">Rich Library</h3>
      <p style="color: #718096; margin: 0;">Pre-loaded professional courses ready to use</p>
    </div>
    <div style="text-align: center; padding: 2rem; background: white; border-radius: 24px; box-shadow: 0 4px 20px rgba(0,0,0,0.06);">
      <div style="font-size: 3rem; margin-bottom: 1rem;">üé®</div>
      <h3 style="margin: 0.5rem 0; font-size: 1.25rem;">Custom Content</h3>
      <p style="color: #718096; margin: 0;">Generate courses from your own materials</p>
    </div>
    <div style="text-align: center; padding: 2rem; background: white; border-radius: 24px; box-shadow: 0 4px 20px rgba(0,0,0,0.06);">
      <div style="width: 64px; height: 64px; margin: 0 auto 1rem; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 20px; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 20px rgba(102, 126, 234, 0.3);">
        <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.894 20.567L16.5 22.5l-.394-1.933a2.25 2.25 0 00-1.423-1.423L12.75 18.75l1.933-.394a2.25 2.25 0 001.423-1.423L16.5 15l.394 1.933a2.25 2.25 0 001.423 1.423l1.933.394-1.933.394a2.25 2.25 0 00-1.423 1.423z" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </div>
      <h3 style="margin: 0.5rem 0; font-size: 1.25rem;">AI-Powered</h3>
      <p style="color: #718096; margin: 0;">Leverages GPT-4 for intelligent content</p>
    </div>
  </div>
</div>

<div id="courses" style="scroll-margin-top: 2rem;">
  <h2 style="text-align: center; margin-bottom: 2rem;">üìö Explore Our Courses</h2>

  <div class="course-grid">
{% for course in collections.courses %}
  {% if loop.index <= 3 %}
  <div class="course-card">
    <h3><a href="{{ course.url }}">{% if course.data.courseId %}{{ course.data.courseId }}: {% endif %}{{ course.data.title or 'Untitled Course' }}</a></h3>
    <p style="flex-grow: 1; color: #4a5568; line-height: 1.7;">{{ course.data.description or course.data.excerpt or 'Explore this course and level up your skills...' }}</p>
    <div style="margin-top: 1.5rem; margin-bottom: 1.5rem;">
      {% if course.data.level %}
      <span class="tag">{{ course.data.level }}</span>
      {% endif %}
      {% if course.data.duration %}
      <span class="tag">‚è±Ô∏è {{ course.data.duration }}</span>
      {% endif %}
    </div>
    <a href="{{ course.url }}" class="btn" style="margin-top: auto; text-align: center;">Explore Course ‚Üí</a>
  </div>
  {% endif %}
{% endfor %}
</div>

{% if collections.courses.length > 3 %}
<div style="text-align: center; margin-top: 3rem;">
  <a href="/courses/" class="btn" style="font-size: 1.1rem; padding: 1rem 2.5rem; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">View All Courses ‚Üí</a>
</div>
{% endif %}

{% if collections.courses.length == 0 %}
<div style="text-align: center; padding: 4rem; background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%); border-radius: 32px; box-shadow: 0 8px 30px rgba(0,0,0,0.08);">
  <div style="font-size: 4rem; margin-bottom: 1rem;">üéì</div>
  <p style="font-size: 1.5rem; color: #1a202c; font-weight: 600; margin-bottom: 1rem;">No courses generated yet</p>
  <p style="color: #4a5568; margin-bottom: 2rem;">Run the Intelligent Photocopier to create your first course!</p>
  <a href="https://github.com/chengxin199/IS601_MidtermProject_Intelligent-Photocopier" class="btn" style="font-size: 1.1rem; padding: 1.25rem 2.5rem;">Get Started on GitHub ‚Üí</a>
</div>
{% endif %}
</div>
